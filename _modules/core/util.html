
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>core.util &#8212; Library Simplified Circulation Manager  documentation</title>
    <link rel="stylesheet" href="../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <h1>Source code for core.util</h1><div class="highlight"><pre>
<span></span><span class="c1"># encoding: utf-8</span>
<span class="s2">&quot;Miscellaneous utilities&quot;</span>
<span class="kn">from</span> <span class="nn">money</span> <span class="k">import</span> <span class="n">Money</span>
<span class="kn">from</span> <span class="nn">nose.tools</span> <span class="k">import</span> <span class="n">set_trace</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="k">import</span> <span class="p">(</span>
    <span class="n">Counter</span><span class="p">,</span>
    <span class="n">defaultdict</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">string</span>
<span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="k">import</span> <span class="n">distinct</span>
<span class="kn">from</span> <span class="nn">sqlalchemy.sql.functions</span> <span class="k">import</span> <span class="n">func</span>

<div class="viewcode-block" id="batch"><a class="viewcode-back" href="../../core.util.html#core.util.batch">[docs]</a><span class="k">def</span> <span class="nf">batch</span><span class="p">(</span><span class="n">iterable</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Split up `iterable` into batches of size `size`.&quot;&quot;&quot;</span>

    <span class="n">l</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">iterable</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">start</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">size</span><span class="p">):</span>
        <span class="k">yield</span> <span class="n">iterable</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="nb">min</span><span class="p">(</span><span class="n">start</span><span class="o">+</span><span class="n">size</span><span class="p">,</span> <span class="n">l</span><span class="p">)]</span></div>

<div class="viewcode-block" id="fast_query_count"><a class="viewcode-back" href="../../core.util.html#core.util.fast_query_count">[docs]</a><span class="k">def</span> <span class="nf">fast_query_count</span><span class="p">(</span><span class="n">query</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Counts the results of a query without using super-slow subquery&quot;&quot;&quot;</span>

    <span class="n">statement</span> <span class="o">=</span> <span class="n">query</span><span class="o">.</span><span class="n">enable_eagerloads</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">with_labels</span><span class="p">()</span><span class="o">.</span><span class="n">statement</span>
    <span class="n">distinct_columns</span> <span class="o">=</span> <span class="n">statement</span><span class="o">.</span><span class="n">_distinct</span>
    <span class="n">new_columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">func</span><span class="o">.</span><span class="n">count</span><span class="p">()]</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">distinct_columns</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="c1"># When using distinct to select from the db, the distinct</span>
        <span class="c1"># columns need to be incorporated into the count itself.</span>
        <span class="n">new_columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">func</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">distinct</span><span class="p">(</span><span class="n">func</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="o">*</span><span class="n">distinct_columns</span><span class="p">)))]</span>

        <span class="c1"># Then we can remove the distinct criteria from the statement</span>
        <span class="c1"># itself by setting it to its default value, False.</span>
        <span class="n">statement</span><span class="o">.</span><span class="n">_distinct</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">count_q</span> <span class="o">=</span> <span class="n">statement</span><span class="o">.</span><span class="n">with_only_columns</span><span class="p">(</span><span class="n">new_columns</span><span class="p">)</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
    <span class="n">count</span> <span class="o">=</span> <span class="n">query</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">count_q</span><span class="p">)</span><span class="o">.</span><span class="n">scalar</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">query</span><span class="o">.</span><span class="n">_limit</span> <span class="ow">and</span> <span class="n">query</span><span class="o">.</span><span class="n">_limit</span> <span class="o">&lt;</span> <span class="n">count</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">query</span><span class="o">.</span><span class="n">_limit</span>

    <span class="k">return</span> <span class="n">count</span></div>

<div class="viewcode-block" id="slugify"><a class="viewcode-back" href="../../core.util.html#core.util.slugify">[docs]</a><span class="k">def</span> <span class="nf">slugify</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">length_limit</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Takes a string and turns it into a slug.</span>

<span class="sd">    :Example:</span>

<span class="sd">    &gt;&gt;&gt; slugify(&#39;Some (???) Title Somewhere&#39;)</span>
<span class="sd">    some-title-somewhere</span>
<span class="sd">    &gt;&gt;&gt; slugify(&#39;Sly &amp; the Family Stone&#39;)</span>
<span class="sd">    sly-and-the-family-stone</span>
<span class="sd">    &gt;&gt;&gt; slugify(&#39;Happy birthday!&#39;, length_limit=4)</span>
<span class="sd">    happ</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">slug</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s1">&#39;[.!@#</span><span class="se">\&#39;</span><span class="s1">$,?\(\)]&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">text</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>
    <span class="n">slug</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s1">&#39;&amp;&#39;</span><span class="p">,</span> <span class="s1">&#39; and &#39;</span><span class="p">,</span> <span class="n">slug</span><span class="p">)</span>
    <span class="n">slug</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s1">&#39; {2,}&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">slug</span><span class="p">)</span>

    <span class="n">slug</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">slug</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">))</span>
    <span class="k">while</span> <span class="s1">&#39;--&#39;</span> <span class="ow">in</span> <span class="n">slug</span><span class="p">:</span>
        <span class="n">slug</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">slug</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">length_limit</span><span class="p">:</span>
        <span class="n">slug</span> <span class="o">=</span> <span class="n">slug</span><span class="p">[:</span><span class="n">length_limit</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">unicode</span><span class="p">(</span><span class="n">slug</span><span class="p">)</span></div>

<div class="viewcode-block" id="LookupTable"><a class="viewcode-back" href="../../core.util.html#core.util.LookupTable">[docs]</a><span class="k">class</span> <span class="nc">LookupTable</span><span class="p">(</span><span class="nb">dict</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return None on x[key] when &#39;key&#39; isn&#39;t in the dictionary,</span>
<span class="sd">    rather than raising a ValueError.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">LookupTable</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span></div>


<div class="viewcode-block" id="LanguageCodes"><a class="viewcode-back" href="../../core.util.html#core.util.LanguageCodes">[docs]</a><span class="k">class</span> <span class="nc">LanguageCodes</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Convert between ISO-639-2 and ISO-693-1 language codes.</span>

<span class="sd">    The data file comes from</span>
<span class="sd">    http://www.loc.gov/standards/iso639-2/ISO-639-2_utf-8.txt</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">two_to_three</span> <span class="o">=</span> <span class="n">LookupTable</span><span class="p">()</span>
    <span class="n">three_to_two</span> <span class="o">=</span> <span class="n">LookupTable</span><span class="p">()</span>
    <span class="n">english_names</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
    <span class="n">english_names_to_three</span> <span class="o">=</span> <span class="n">LookupTable</span><span class="p">()</span>
    <span class="n">native_names</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>

    <span class="n">RAW_DATA</span> <span class="o">=</span> <span class="sa">u</span><span class="s2">&quot;&quot;&quot;aar||aa|Afar|afar</span>
<span class="s2">abk||ab|Abkhazian|abkhaze</span>
<span class="s2">ace|||Achinese|aceh</span>
<span class="s2">ach|||Acoli|acoli</span>
<span class="s2">ada|||Adangme|adangme</span>
<span class="s2">ady|||Adyghe; Adygei|adyghé</span>
<span class="s2">afa|||Afro-Asiatic languages|afro-asiatiques, langues</span>
<span class="s2">afh|||Afrihili|afrihili</span>
<span class="s2">afr||af|Afrikaans|afrikaans</span>
<span class="s2">ain|||Ainu|aïnou</span>
<span class="s2">aka||ak|Akan|akan</span>
<span class="s2">akk|||Akkadian|akkadien</span>
<span class="s2">alb|sqi|sq|Albanian|albanais</span>
<span class="s2">ale|||Aleut|aléoute</span>
<span class="s2">alg|||Algonquian languages|algonquines, langues</span>
<span class="s2">alt|||Southern Altai|altai du Sud</span>
<span class="s2">amh||am|Amharic|amharique</span>
<span class="s2">ang|||English, Old (ca.450-1100)|anglo-saxon (ca.450-1100)</span>
<span class="s2">anp|||Angika|angika</span>
<span class="s2">apa|||Apache languages|apaches, langues</span>
<span class="s2">ara||ar|Arabic|arabe</span>
<span class="s2">arc|||Official Aramaic (700-300 BCE); Imperial Aramaic (700-300 BCE)|araméen d&#39;empire (700-300 BCE)</span>
<span class="s2">arg||an|Aragonese|aragonais</span>
<span class="s2">arm|hye|hy|Armenian|arménien</span>
<span class="s2">arn|||Mapudungun; Mapuche|mapudungun; mapuche; mapuce</span>
<span class="s2">arp|||Arapaho|arapaho</span>
<span class="s2">art|||Artificial languages|artificielles, langues</span>
<span class="s2">arw|||Arawak|arawak</span>
<span class="s2">asm||as|Assamese|assamais</span>
<span class="s2">ast|||Asturian; Bable; Leonese; Asturleonese|asturien; bable; léonais; asturoléonais</span>
<span class="s2">ath|||Athapascan languages|athapascanes, langues</span>
<span class="s2">aus|||Australian languages|australiennes, langues</span>
<span class="s2">ava||av|Avaric|avar</span>
<span class="s2">ave||ae|Avestan|avestique</span>
<span class="s2">awa|||Awadhi|awadhi</span>
<span class="s2">aym||ay|Aymara|aymara</span>
<span class="s2">aze||az|Azerbaijani|azéri</span>
<span class="s2">bad|||Banda languages|banda, langues</span>
<span class="s2">bai|||Bamileke languages|bamiléké, langues</span>
<span class="s2">bak||ba|Bashkir|bachkir</span>
<span class="s2">bal|||Baluchi|baloutchi</span>
<span class="s2">bam||bm|Bambara|bambara</span>
<span class="s2">ban|||Balinese|balinais</span>
<span class="s2">baq|eus|eu|Basque|basque</span>
<span class="s2">bas|||Basa|basa</span>
<span class="s2">bat|||Baltic languages|baltes, langues</span>
<span class="s2">bej|||Beja; Bedawiyet|bedja</span>
<span class="s2">bel||be|Belarusian|biélorusse</span>
<span class="s2">bem|||Bemba|bemba</span>
<span class="s2">ben||bn|Bengali|bengali</span>
<span class="s2">ber|||Berber languages|berbères, langues</span>
<span class="s2">bho|||Bhojpuri|bhojpuri</span>
<span class="s2">bih||bh|Bihari languages|langues biharis</span>
<span class="s2">bik|||Bikol|bikol</span>
<span class="s2">bin|||Bini; Edo|bini; edo</span>
<span class="s2">bis||bi|Bislama|bichlamar</span>
<span class="s2">bla|||Siksika|blackfoot</span>
<span class="s2">bnt|||Bantu (Other)|bantoues, autres langues</span>
<span class="s2">bos||bs|Bosnian|bosniaque</span>
<span class="s2">bra|||Braj|braj</span>
<span class="s2">bre||br|Breton|breton</span>
<span class="s2">btk|||Batak languages|batak, langues</span>
<span class="s2">bua|||Buriat|bouriate</span>
<span class="s2">bug|||Buginese|bugi</span>
<span class="s2">bul||bg|Bulgarian|bulgare</span>
<span class="s2">bur|mya|my|Burmese|birman</span>
<span class="s2">byn|||Blin; Bilin|blin; bilen</span>
<span class="s2">cad|||Caddo|caddo</span>
<span class="s2">cai|||Central American Indian languages|amérindiennes de L&#39;Amérique centrale, langues</span>
<span class="s2">car|||Galibi Carib|karib; galibi; carib</span>
<span class="s2">cat||ca|Catalan; Valencian|catalan; valencien</span>
<span class="s2">cau|||Caucasian languages|caucasiennes, langues</span>
<span class="s2">ceb|||Cebuano|cebuano</span>
<span class="s2">cel|||Celtic languages|celtiques, langues; celtes, langues</span>
<span class="s2">cha||ch|Chamorro|chamorro</span>
<span class="s2">chb|||Chibcha|chibcha</span>
<span class="s2">che||ce|Chechen|tchétchène</span>
<span class="s2">chg|||Chagatai|djaghataï</span>
<span class="s2">chi|zho|zh|Chinese|chinois</span>
<span class="s2">chk|||Chuukese|chuuk</span>
<span class="s2">chm|||Mari|mari</span>
<span class="s2">chn|||Chinook jargon|chinook, jargon</span>
<span class="s2">cho|||Choctaw|choctaw</span>
<span class="s2">chp|||Chipewyan; Dene Suline|chipewyan</span>
<span class="s2">chr|||Cherokee|cherokee</span>
<span class="s2">chu||cu|Church Slavic; Old Slavonic; Church Slavonic; Old Bulgarian; Old Church Slavonic|slavon d&#39;église; vieux slave; slavon liturgique; vieux bulgare</span>
<span class="s2">chv||cv|Chuvash|tchouvache</span>
<span class="s2">chy|||Cheyenne|cheyenne</span>
<span class="s2">cmc|||Chamic languages|chames, langues</span>
<span class="s2">cop|||Coptic|copte</span>
<span class="s2">cor||kw|Cornish|cornique</span>
<span class="s2">cos||co|Corsican|corse</span>
<span class="s2">cpe|||Creoles and pidgins, English based|créoles et pidgins basés sur l&#39;anglais</span>
<span class="s2">cpf|||Creoles and pidgins, French-based |créoles et pidgins basés sur le français</span>
<span class="s2">cpp|||Creoles and pidgins, Portuguese-based |créoles et pidgins basés sur le portugais</span>
<span class="s2">cre||cr|Cree|cree</span>
<span class="s2">crh|||Crimean Tatar; Crimean Turkish|tatar de Crimé</span>
<span class="s2">crp|||Creoles and pidgins |créoles et pidgins</span>
<span class="s2">csb|||Kashubian|kachoube</span>
<span class="s2">cus|||Cushitic languages|couchitiques, langues</span>
<span class="s2">cze|ces|cs|Czech|tchèque</span>
<span class="s2">dak|||Dakota|dakota</span>
<span class="s2">dan||da|Danish|danois</span>
<span class="s2">dar|||Dargwa|dargwa</span>
<span class="s2">day|||Land Dayak languages|dayak, langues</span>
<span class="s2">del|||Delaware|delaware</span>
<span class="s2">den|||Slave (Athapascan)|esclave (athapascan)</span>
<span class="s2">dgr|||Dogrib|dogrib</span>
<span class="s2">din|||Dinka|dinka</span>
<span class="s2">div||dv|Divehi; Dhivehi; Maldivian|maldivien</span>
<span class="s2">doi|||Dogri|dogri</span>
<span class="s2">dra|||Dravidian languages|dravidiennes, langues</span>
<span class="s2">dsb|||Lower Sorbian|bas-sorabe</span>
<span class="s2">dua|||Duala|douala</span>
<span class="s2">dum|||Dutch, Middle (ca.1050-1350)|néerlandais moyen (ca. 1050-1350)</span>
<span class="s2">dut|nld|nl|Dutch; Flemish|néerlandais; flamand</span>
<span class="s2">dyu|||Dyula|dioula</span>
<span class="s2">dzo||dz|Dzongkha|dzongkha</span>
<span class="s2">efi|||Efik|efik</span>
<span class="s2">egy|||Egyptian (Ancient)|égyptien</span>
<span class="s2">eka|||Ekajuk|ekajuk</span>
<span class="s2">elx|||Elamite|élamite</span>
<span class="s2">eng||en|English|anglais</span>
<span class="s2">enm|||English, Middle (1100-1500)|anglais moyen (1100-1500)</span>
<span class="s2">epo||eo|Esperanto|espéranto</span>
<span class="s2">est||et|Estonian|estonien</span>
<span class="s2">ewe||ee|Ewe|éwé</span>
<span class="s2">ewo|||Ewondo|éwondo</span>
<span class="s2">fan|||Fang|fang</span>
<span class="s2">fao||fo|Faroese|féroïen</span>
<span class="s2">fat|||Fanti|fanti</span>
<span class="s2">fij||fj|Fijian|fidjien</span>
<span class="s2">fil|||Filipino; Pilipino|filipino; pilipino</span>
<span class="s2">fin||fi|Finnish|finnois</span>
<span class="s2">fiu|||Finno-Ugrian languages|finno-ougriennes, langues</span>
<span class="s2">fon|||Fon|fon</span>
<span class="s2">fre|fra|fr|French|français</span>
<span class="s2">frm|||French, Middle (ca.1400-1600)|français moyen (1400-1600)</span>
<span class="s2">fro|||French, Old (842-ca.1400)|français ancien (842-ca.1400)</span>
<span class="s2">frr|||Northern Frisian|frison septentrional</span>
<span class="s2">frs|||Eastern Frisian|frison oriental</span>
<span class="s2">fry||fy|Western Frisian|frison occidental</span>
<span class="s2">ful||ff|Fulah|peul</span>
<span class="s2">fur|||Friulian|frioulan</span>
<span class="s2">gaa|||Ga|ga</span>
<span class="s2">gay|||Gayo|gayo</span>
<span class="s2">gba|||Gbaya|gbaya</span>
<span class="s2">gem|||Germanic languages|germaniques, langues</span>
<span class="s2">geo|kat|ka|Georgian|géorgien</span>
<span class="s2">ger|deu|de|German|allemand</span>
<span class="s2">gez|||Geez|guèze</span>
<span class="s2">gil|||Gilbertese|kiribati</span>
<span class="s2">gla||gd|Gaelic; Scottish Gaelic|gaélique; gaélique écossais</span>
<span class="s2">gle||ga|Irish|irlandais</span>
<span class="s2">glg||gl|Galician|galicien</span>
<span class="s2">glv||gv|Manx|manx; mannois</span>
<span class="s2">gmh|||German, Middle High (ca.1050-1500)|allemand, moyen haut (ca. 1050-1500)</span>
<span class="s2">goh|||German, Old High (ca.750-1050)|allemand, vieux haut (ca. 750-1050)</span>
<span class="s2">gon|||Gondi|gond</span>
<span class="s2">gor|||Gorontalo|gorontalo</span>
<span class="s2">got|||Gothic|gothique</span>
<span class="s2">grb|||Grebo|grebo</span>
<span class="s2">grc|||Greek, Ancient (to 1453)|grec ancien (jusqu&#39;à 1453)</span>
<span class="s2">gre|ell|el|Greek, Modern (1453-)|grec moderne (après 1453)</span>
<span class="s2">grn||gn|Guarani|guarani</span>
<span class="s2">gsw|||Swiss German; Alemannic; Alsatian|suisse alémanique; alémanique; alsacien</span>
<span class="s2">guj||gu|Gujarati|goudjrati</span>
<span class="s2">gwi|||Gwich&#39;in|gwich&#39;in</span>
<span class="s2">hai|||Haida|haida</span>
<span class="s2">hat||ht|Haitian; Haitian Creole|haïtien; créole haïtien</span>
<span class="s2">hau||ha|Hausa|haoussa</span>
<span class="s2">haw|||Hawaiian|hawaïen</span>
<span class="s2">heb||he|Hebrew|hébreu</span>
<span class="s2">her||hz|Herero|herero</span>
<span class="s2">hil|||Hiligaynon|hiligaynon</span>
<span class="s2">him|||Himachali languages; Western Pahari languages|langues himachalis; langues paharis occidentales</span>
<span class="s2">hin||hi|Hindi|hindi</span>
<span class="s2">hit|||Hittite|hittite</span>
<span class="s2">hmn|||Hmong; Mong|hmong</span>
<span class="s2">hmo||ho|Hiri Motu|hiri motu</span>
<span class="s2">hrv||hr|Croatian|croate</span>
<span class="s2">hsb|||Upper Sorbian|haut-sorabe</span>
<span class="s2">hun||hu|Hungarian|hongrois</span>
<span class="s2">hup|||Hupa|hupa</span>
<span class="s2">iba|||Iban|iban</span>
<span class="s2">ibo||ig|Igbo|igbo</span>
<span class="s2">ice|isl|is|Icelandic|islandais</span>
<span class="s2">ido||io|Ido|ido</span>
<span class="s2">iii||ii|Sichuan Yi; Nuosu|yi de Sichuan</span>
<span class="s2">ijo|||Ijo languages|ijo, langues</span>
<span class="s2">iku||iu|Inuktitut|inuktitut</span>
<span class="s2">ile||ie|Interlingue; Occidental|interlingue</span>
<span class="s2">ilo|||Iloko|ilocano</span>
<span class="s2">ina||ia|Interlingua (International Auxiliary Language Association)|interlingua (langue auxiliaire internationale)</span>
<span class="s2">inc|||Indic languages|indo-aryennes, langues</span>
<span class="s2">ind||id|Indonesian|indonésien</span>
<span class="s2">ine|||Indo-European languages|indo-européennes, langues</span>
<span class="s2">inh|||Ingush|ingouche</span>
<span class="s2">ipk||ik|Inupiaq|inupiaq</span>
<span class="s2">ira|||Iranian languages|iraniennes, langues</span>
<span class="s2">iro|||Iroquoian languages|iroquoises, langues</span>
<span class="s2">ita||it|Italian|italien</span>
<span class="s2">jav||jv|Javanese|javanais</span>
<span class="s2">jbo|||Lojban|lojban</span>
<span class="s2">jpn||ja|Japanese|japonais</span>
<span class="s2">jpr|||Judeo-Persian|judéo-persan</span>
<span class="s2">jrb|||Judeo-Arabic|judéo-arabe</span>
<span class="s2">kaa|||Kara-Kalpak|karakalpak</span>
<span class="s2">kab|||Kabyle|kabyle</span>
<span class="s2">kac|||Kachin; Jingpho|kachin; jingpho</span>
<span class="s2">kal||kl|Kalaallisut; Greenlandic|groenlandais</span>
<span class="s2">kam|||Kamba|kamba</span>
<span class="s2">kan||kn|Kannada|kannada</span>
<span class="s2">kar|||Karen languages|karen, langues</span>
<span class="s2">kas||ks|Kashmiri|kashmiri</span>
<span class="s2">kau||kr|Kanuri|kanouri</span>
<span class="s2">kaw|||Kawi|kawi</span>
<span class="s2">kaz||kk|Kazakh|kazakh</span>
<span class="s2">kbd|||Kabardian|kabardien</span>
<span class="s2">kha|||Khasi|khasi</span>
<span class="s2">khi|||Khoisan languages|khoïsan, langues</span>
<span class="s2">khm||km|Central Khmer|khmer central</span>
<span class="s2">kho|||Khotanese; Sakan|khotanais; sakan</span>
<span class="s2">kik||ki|Kikuyu; Gikuyu|kikuyu</span>
<span class="s2">kin||rw|Kinyarwanda|rwanda</span>
<span class="s2">kir||ky|Kirghiz; Kyrgyz|kirghiz</span>
<span class="s2">kmb|||Kimbundu|kimbundu</span>
<span class="s2">kok|||Konkani|konkani</span>
<span class="s2">kom||kv|Komi|kom</span>
<span class="s2">kon||kg|Kongo|kongo</span>
<span class="s2">kor||ko|Korean|coréen</span>
<span class="s2">kos|||Kosraean|kosrae</span>
<span class="s2">kpe|||Kpelle|kpellé</span>
<span class="s2">krc|||Karachay-Balkar|karatchai balkar</span>
<span class="s2">krl|||Karelian|carélien</span>
<span class="s2">kro|||Kru languages|krou, langues</span>
<span class="s2">kru|||Kurukh|kurukh</span>
<span class="s2">kua||kj|Kuanyama; Kwanyama|kuanyama; kwanyama</span>
<span class="s2">kum|||Kumyk|koumyk</span>
<span class="s2">kur||ku|Kurdish|kurde</span>
<span class="s2">kut|||Kutenai|kutenai</span>
<span class="s2">lad|||Ladino|judéo-espagnol</span>
<span class="s2">lah|||Lahnda|lahnda</span>
<span class="s2">lam|||Lamba|lamba</span>
<span class="s2">lao||lo|Lao|lao</span>
<span class="s2">lat||la|Latin|latin</span>
<span class="s2">lav||lv|Latvian|letton</span>
<span class="s2">lez|||Lezghian|lezghien</span>
<span class="s2">lim||li|Limburgan; Limburger; Limburgish|limbourgeois</span>
<span class="s2">lin||ln|Lingala|lingala</span>
<span class="s2">lit||lt|Lithuanian|lituanien</span>
<span class="s2">lol|||Mongo|mongo</span>
<span class="s2">loz|||Lozi|lozi</span>
<span class="s2">ltz||lb|Luxembourgish; Letzeburgesch|luxembourgeois</span>
<span class="s2">lua|||Luba-Lulua|luba-lulua</span>
<span class="s2">lub||lu|Luba-Katanga|luba-katanga</span>
<span class="s2">lug||lg|Ganda|ganda</span>
<span class="s2">lui|||Luiseno|luiseno</span>
<span class="s2">lun|||Lunda|lunda</span>
<span class="s2">luo|||Luo (Kenya and Tanzania)|luo (Kenya et Tanzanie)</span>
<span class="s2">lus|||Lushai|lushai</span>
<span class="s2">mac|mkd|mk|Macedonian|macédonien</span>
<span class="s2">mad|||Madurese|madourais</span>
<span class="s2">mag|||Magahi|magahi</span>
<span class="s2">mah||mh|Marshallese|marshall</span>
<span class="s2">mai|||Maithili|maithili</span>
<span class="s2">mak|||Makasar|makassar</span>
<span class="s2">mal||ml|Malayalam|malayalam</span>
<span class="s2">man|||Mandingo|mandingue</span>
<span class="s2">mao|mri|mi|Maori|maori</span>
<span class="s2">map|||Austronesian languages|austronésiennes, langues</span>
<span class="s2">mar||mr|Marathi|marathe</span>
<span class="s2">mas|||Masai|massaï</span>
<span class="s2">may|msa|ms|Malay|malais</span>
<span class="s2">mdf|||Moksha|moksa</span>
<span class="s2">mdr|||Mandar|mandar</span>
<span class="s2">men|||Mende|mendé</span>
<span class="s2">mga|||Irish, Middle (900-1200)|irlandais moyen (900-1200)</span>
<span class="s2">mic|||Mi&#39;kmaq; Micmac|mi&#39;kmaq; micmac</span>
<span class="s2">min|||Minangkabau|minangkabau</span>
<span class="s2">mis|||Uncoded languages|langues non codées</span>
<span class="s2">mkh|||Mon-Khmer languages|môn-khmer, langues</span>
<span class="s2">mlg||mg|Malagasy|malgache</span>
<span class="s2">mlt||mt|Maltese|maltais</span>
<span class="s2">mnc|||Manchu|mandchou</span>
<span class="s2">mni|||Manipuri|manipuri</span>
<span class="s2">mno|||Manobo languages|manobo, langues</span>
<span class="s2">moh|||Mohawk|mohawk</span>
<span class="s2">mon||mn|Mongolian|mongol</span>
<span class="s2">mos|||Mossi|moré</span>
<span class="s2">mul|||Multiple languages|multilingue</span>
<span class="s2">mun|||Munda languages|mounda, langues</span>
<span class="s2">mus|||Creek|muskogee</span>
<span class="s2">mwl|||Mirandese|mirandais</span>
<span class="s2">mwr|||Marwari|marvari</span>
<span class="s2">myn|||Mayan languages|maya, langues</span>
<span class="s2">myv|||Erzya|erza</span>
<span class="s2">nah|||Nahuatl languages|nahuatl, langues</span>
<span class="s2">nai|||North American Indian languages|nord-amérindiennes, langues</span>
<span class="s2">nap|||Neapolitan|napolitain</span>
<span class="s2">nau||na|Nauru|nauruan</span>
<span class="s2">nav||nv|Navajo; Navaho|navaho</span>
<span class="s2">nbl||nr|Ndebele, South; South Ndebele|ndébélé du Sud</span>
<span class="s2">nde||nd|Ndebele, North; North Ndebele|ndébélé du Nord</span>
<span class="s2">ndo||ng|Ndonga|ndonga</span>
<span class="s2">nds|||Low German; Low Saxon; German, Low; Saxon, Low|bas allemand; bas saxon; allemand, bas; saxon, bas</span>
<span class="s2">nep||ne|Nepali|népalais</span>
<span class="s2">new|||Nepal Bhasa; Newari|nepal bhasa; newari</span>
<span class="s2">nia|||Nias|nias</span>
<span class="s2">nic|||Niger-Kordofanian languages|nigéro-kordofaniennes, langues</span>
<span class="s2">niu|||Niuean|niué</span>
<span class="s2">nno||nn|Norwegian Nynorsk; Nynorsk, Norwegian|norvégien nynorsk; nynorsk, norvégien</span>
<span class="s2">nob||nb|Bokmål, Norwegian; Norwegian Bokmål|norvégien bokmål</span>
<span class="s2">nog|||Nogai|nogaï; nogay</span>
<span class="s2">non|||Norse, Old|norrois, vieux</span>
<span class="s2">nor||no|Norwegian|norvégien</span>
<span class="s2">nqo|||N&#39;Ko|n&#39;ko</span>
<span class="s2">nso|||Pedi; Sepedi; Northern Sotho|pedi; sepedi; sotho du Nord</span>
<span class="s2">nub|||Nubian languages|nubiennes, langues</span>
<span class="s2">nwc|||Classical Newari; Old Newari; Classical Nepal Bhasa|newari classique</span>
<span class="s2">nya||ny|Chichewa; Chewa; Nyanja|chichewa; chewa; nyanja</span>
<span class="s2">nym|||Nyamwezi|nyamwezi</span>
<span class="s2">nyn|||Nyankole|nyankolé</span>
<span class="s2">nyo|||Nyoro|nyoro</span>
<span class="s2">nzi|||Nzima|nzema</span>
<span class="s2">oci||oc|Occitan (post 1500); Provençal|occitan (après 1500); provençal</span>
<span class="s2">oji||oj|Ojibwa|ojibwa</span>
<span class="s2">ori||or|Oriya|oriya</span>
<span class="s2">orm||om|Oromo|galla</span>
<span class="s2">osa|||Osage|osage</span>
<span class="s2">oss||os|Ossetian; Ossetic|ossète</span>
<span class="s2">ota|||Turkish, Ottoman (1500-1928)|turc ottoman (1500-1928)</span>
<span class="s2">oto|||Otomian languages|otomi, langues</span>
<span class="s2">paa|||Papuan languages|papoues, langues</span>
<span class="s2">pag|||Pangasinan|pangasinan</span>
<span class="s2">pal|||Pahlavi|pahlavi</span>
<span class="s2">pam|||Pampanga; Kapampangan|pampangan</span>
<span class="s2">pan||pa|Panjabi; Punjabi|pendjabi</span>
<span class="s2">pap|||Papiamento|papiamento</span>
<span class="s2">pau|||Palauan|palau</span>
<span class="s2">peo|||Persian, Old (ca.600-400 B.C.)|perse, vieux (ca. 600-400 av. J.-C.)</span>
<span class="s2">per|fas|fa|Persian|persan</span>
<span class="s2">phi|||Philippine languages|philippines, langues</span>
<span class="s2">phn|||Phoenician|phénicien</span>
<span class="s2">pli||pi|Pali|pali</span>
<span class="s2">pol||pl|Polish|polonais</span>
<span class="s2">pon|||Pohnpeian|pohnpei</span>
<span class="s2">por||pt|Portuguese|portugais</span>
<span class="s2">pra|||Prakrit languages|prâkrit, langues</span>
<span class="s2">pro|||Provençal, Old (to 1500)|provençal ancien (jusqu&#39;à 1500)</span>
<span class="s2">pus||ps|Pushto; Pashto|pachto</span>
<span class="s2">qaa-qtz|||Reserved for local use|réservée à l&#39;usage local</span>
<span class="s2">que||qu|Quechua|quechua</span>
<span class="s2">raj|||Rajasthani|rajasthani</span>
<span class="s2">rap|||Rapanui|rapanui</span>
<span class="s2">rar|||Rarotongan; Cook Islands Maori|rarotonga; maori des îles Cook</span>
<span class="s2">roa|||Romance languages|romanes, langues</span>
<span class="s2">roh||rm|Romansh|romanche</span>
<span class="s2">rom|||Romany|tsigane</span>
<span class="s2">rum|ron|ro|Romanian; Moldavian; Moldovan|roumain; moldave</span>
<span class="s2">run||rn|Rundi|rundi</span>
<span class="s2">rup|||Aromanian; Arumanian; Macedo-Romanian|aroumain; macédo-roumain</span>
<span class="s2">rus||ru|Russian|russe</span>
<span class="s2">sad|||Sandawe|sandawe</span>
<span class="s2">sag||sg|Sango|sango</span>
<span class="s2">sah|||Yakut|iakoute</span>
<span class="s2">sai|||South American Indian (Other)|indiennes d&#39;Amérique du Sud, autres langues</span>
<span class="s2">sal|||Salishan languages|salishennes, langues</span>
<span class="s2">sam|||Samaritan Aramaic|samaritain</span>
<span class="s2">san||sa|Sanskrit|sanskrit</span>
<span class="s2">sas|||Sasak|sasak</span>
<span class="s2">sat|||Santali|santal</span>
<span class="s2">scn|||Sicilian|sicilien</span>
<span class="s2">sco|||Scots|écossais</span>
<span class="s2">sel|||Selkup|selkoupe</span>
<span class="s2">sem|||Semitic languages|sémitiques, langues</span>
<span class="s2">sga|||Irish, Old (to 900)|irlandais ancien (jusqu&#39;à 900)</span>
<span class="s2">sgn|||Sign Languages|langues des signes</span>
<span class="s2">shn|||Shan|chan</span>
<span class="s2">sid|||Sidamo|sidamo</span>
<span class="s2">sin||si|Sinhala; Sinhalese|singhalais</span>
<span class="s2">sio|||Siouan languages|sioux, langues</span>
<span class="s2">sit|||Sino-Tibetan languages|sino-tibétaines, langues</span>
<span class="s2">sla|||Slavic languages|slaves, langues</span>
<span class="s2">slo|slk|sk|Slovak|slovaque</span>
<span class="s2">slv||sl|Slovenian|slovène</span>
<span class="s2">sma|||Southern Sami|sami du Sud</span>
<span class="s2">sme||se|Northern Sami|sami du Nord</span>
<span class="s2">smi|||Sami languages|sames, langues</span>
<span class="s2">smj|||Lule Sami|sami de Lule</span>
<span class="s2">smn|||Inari Sami|sami d&#39;Inari</span>
<span class="s2">smo||sm|Samoan|samoan</span>
<span class="s2">sms|||Skolt Sami|sami skolt</span>
<span class="s2">sna||sn|Shona|shona</span>
<span class="s2">snd||sd|Sindhi|sindhi</span>
<span class="s2">snk|||Soninke|soninké</span>
<span class="s2">sog|||Sogdian|sogdien</span>
<span class="s2">som||so|Somali|somali</span>
<span class="s2">son|||Songhai languages|songhai, langues</span>
<span class="s2">sot||st|Sotho, Southern|sotho du Sud</span>
<span class="s2">spa||es|Spanish; Castilian|espagnol; castillan</span>
<span class="s2">srd||sc|Sardinian|sarde</span>
<span class="s2">srn|||Sranan Tongo|sranan tongo</span>
<span class="s2">srp||sr|Serbian|serbe</span>
<span class="s2">srr|||Serer|sérère</span>
<span class="s2">ssa|||Nilo-Saharan languages|nilo-sahariennes, langues</span>
<span class="s2">ssw||ss|Swati|swati</span>
<span class="s2">suk|||Sukuma|sukuma</span>
<span class="s2">sun||su|Sundanese|soundanais</span>
<span class="s2">sus|||Susu|soussou</span>
<span class="s2">sux|||Sumerian|sumérien</span>
<span class="s2">swa||sw|Swahili|swahili</span>
<span class="s2">swe||sv|Swedish|suédois</span>
<span class="s2">syc|||Classical Syriac|syriaque classique</span>
<span class="s2">syr|||Syriac|syriaque</span>
<span class="s2">tah||ty|Tahitian|tahitien</span>
<span class="s2">tai|||Tai languages|tai, langues</span>
<span class="s2">tam||ta|Tamil|tamoul</span>
<span class="s2">tat||tt|Tatar|tatar</span>
<span class="s2">tel||te|Telugu|télougou</span>
<span class="s2">tem|||Timne|temne</span>
<span class="s2">ter|||Tereno|tereno</span>
<span class="s2">tet|||Tetum|tetum</span>
<span class="s2">tgk||tg|Tajik|tadjik</span>
<span class="s2">tgl||tl|Tagalog|tagalog</span>
<span class="s2">tha||th|Thai|thaï</span>
<span class="s2">tib|bod|bo|Tibetan|tibétain</span>
<span class="s2">tig|||Tigre|tigré</span>
<span class="s2">tir||ti|Tigrinya|tigrigna</span>
<span class="s2">tiv|||Tiv|tiv</span>
<span class="s2">tkl|||Tokelau|tokelau</span>
<span class="s2">tlh|||Klingon; tlhIngan-Hol|klingon</span>
<span class="s2">tli|||Tlingit|tlingit</span>
<span class="s2">tmh|||Tamashek|tamacheq</span>
<span class="s2">tog|||Tonga (Nyasa)|tonga (Nyasa)</span>
<span class="s2">ton||to|Tonga (Tonga Islands)|tongan (Îles Tonga)</span>
<span class="s2">tpi|||Tok Pisin|tok pisin</span>
<span class="s2">tsi|||Tsimshian|tsimshian</span>
<span class="s2">tsn||tn|Tswana|tswana</span>
<span class="s2">tso||ts|Tsonga|tsonga</span>
<span class="s2">tuk||tk|Turkmen|turkmène</span>
<span class="s2">tum|||Tumbuka|tumbuka</span>
<span class="s2">tup|||Tupi languages|tupi, langues</span>
<span class="s2">tur||tr|Turkish|turc</span>
<span class="s2">tut|||Altaic languages|altaïques, langues</span>
<span class="s2">tvl|||Tuvalu|tuvalu</span>
<span class="s2">twi||tw|Twi|twi</span>
<span class="s2">tyv|||Tuvinian|touva</span>
<span class="s2">udm|||Udmurt|oudmourte</span>
<span class="s2">uga|||Ugaritic|ougaritique</span>
<span class="s2">uig||ug|Uighur; Uyghur|ouïgour</span>
<span class="s2">ukr||uk|Ukrainian|ukrainien</span>
<span class="s2">umb|||Umbundu|umbundu</span>
<span class="s2">und|||Undetermined|indéterminée</span>
<span class="s2">urd||ur|Urdu|ourdou</span>
<span class="s2">uzb||uz|Uzbek|ouszbek</span>
<span class="s2">vai|||Vai|vaï</span>
<span class="s2">ven||ve|Venda|venda</span>
<span class="s2">vie||vi|Vietnamese|vietnamien</span>
<span class="s2">vol||vo|Volapük|volapük</span>
<span class="s2">vot|||Votic|vote</span>
<span class="s2">wak|||Wakashan languages|wakashanes, langues</span>
<span class="s2">wal|||Walamo|walamo</span>
<span class="s2">war|||Waray|waray</span>
<span class="s2">was|||Washo|washo</span>
<span class="s2">wel|cym|cy|Welsh|gallois</span>
<span class="s2">wen|||Sorbian languages|sorabes, langues</span>
<span class="s2">wln||wa|Walloon|wallon</span>
<span class="s2">wol||wo|Wolof|wolof</span>
<span class="s2">xal|||Kalmyk; Oirat|kalmouk; oïrat</span>
<span class="s2">xho||xh|Xhosa|xhosa</span>
<span class="s2">yao|||Yao|yao</span>
<span class="s2">yap|||Yapese|yapois</span>
<span class="s2">yid||yi|Yiddish|yiddish</span>
<span class="s2">yor||yo|Yoruba|yoruba</span>
<span class="s2">ypk|||Yupik languages|yupik, langues</span>
<span class="s2">zap|||Zapotec|zapotèque</span>
<span class="s2">zbl|||Blissymbols; Blissymbolics; Bliss|symboles Bliss; Bliss</span>
<span class="s2">zen|||Zenaga|zenaga</span>
<span class="s2">zgh|||Standard Moroccan Tamazight|amazighe standard marocain</span>
<span class="s2">zha||za|Zhuang; Chuang|zhuang; chuang</span>
<span class="s2">znd|||Zande languages|zandé, langues</span>
<span class="s2">zul||zu|Zulu|zoulou</span>
<span class="s2">zun|||Zuni|zuni</span>
<span class="s2">zxx|||No linguistic content; Not applicable|pas de contenu linguistique; non applicable</span>
<span class="s2">zza|||Zaza; Dimili; Dimli; Kirdki; Kirmanjki; Zazaki|zaza; dimili; dimli; kirdki; kirmanjki; zazaki&quot;&quot;&quot;</span>

    <span class="n">NATIVE_NAMES_RAW_DATA</span> <span class="o">=</span>  <span class="p">[</span>
        <span class="p">{</span><span class="s2">&quot;code&quot;</span><span class="p">:</span><span class="s2">&quot;en&quot;</span><span class="p">,</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;English&quot;</span><span class="p">,</span><span class="s2">&quot;nativeName&quot;</span><span class="p">:</span><span class="sa">u</span><span class="s2">&quot;English&quot;</span><span class="p">},</span>
        <span class="p">{</span><span class="s2">&quot;code&quot;</span><span class="p">:</span><span class="s2">&quot;fr&quot;</span><span class="p">,</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;French&quot;</span><span class="p">,</span><span class="s2">&quot;nativeName&quot;</span><span class="p">:</span><span class="sa">u</span><span class="s2">&quot;français&quot;</span><span class="p">},</span>
        <span class="p">{</span><span class="s2">&quot;code&quot;</span><span class="p">:</span><span class="s2">&quot;de&quot;</span><span class="p">,</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;German&quot;</span><span class="p">,</span><span class="s2">&quot;nativeName&quot;</span><span class="p">:</span><span class="sa">u</span><span class="s2">&quot;Deutsch&quot;</span><span class="p">},</span>
        <span class="p">{</span><span class="s2">&quot;code&quot;</span><span class="p">:</span><span class="s2">&quot;el&quot;</span><span class="p">,</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;Greek, Modern&quot;</span><span class="p">,</span><span class="s2">&quot;nativeName&quot;</span><span class="p">:</span><span class="sa">u</span><span class="s2">&quot;Ελληνικά&quot;</span><span class="p">},</span>
        <span class="p">{</span><span class="s2">&quot;code&quot;</span><span class="p">:</span><span class="s2">&quot;hu&quot;</span><span class="p">,</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;Hungarian&quot;</span><span class="p">,</span><span class="s2">&quot;nativeName&quot;</span><span class="p">:</span><span class="sa">u</span><span class="s2">&quot;Magyar&quot;</span><span class="p">},</span>
        <span class="p">{</span><span class="s2">&quot;code&quot;</span><span class="p">:</span><span class="s2">&quot;it&quot;</span><span class="p">,</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;Italian&quot;</span><span class="p">,</span><span class="s2">&quot;nativeName&quot;</span><span class="p">:</span><span class="sa">u</span><span class="s2">&quot;Italiano&quot;</span><span class="p">},</span>
        <span class="p">{</span><span class="s2">&quot;code&quot;</span><span class="p">:</span><span class="s2">&quot;no&quot;</span><span class="p">,</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;Norwegian&quot;</span><span class="p">,</span><span class="s2">&quot;nativeName&quot;</span><span class="p">:</span><span class="sa">u</span><span class="s2">&quot;Norsk&quot;</span><span class="p">},</span>
        <span class="p">{</span><span class="s2">&quot;code&quot;</span><span class="p">:</span><span class="s2">&quot;pl&quot;</span><span class="p">,</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;Polish&quot;</span><span class="p">,</span><span class="s2">&quot;nativeName&quot;</span><span class="p">:</span><span class="sa">u</span><span class="s2">&quot;polski&quot;</span><span class="p">},</span>
        <span class="p">{</span><span class="s2">&quot;code&quot;</span><span class="p">:</span><span class="s2">&quot;pt&quot;</span><span class="p">,</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;Portuguese&quot;</span><span class="p">,</span><span class="s2">&quot;nativeName&quot;</span><span class="p">:</span><span class="sa">u</span><span class="s2">&quot;Português&quot;</span><span class="p">},</span>
        <span class="p">{</span><span class="s2">&quot;code&quot;</span><span class="p">:</span><span class="s2">&quot;ru&quot;</span><span class="p">,</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;Russian&quot;</span><span class="p">,</span><span class="s2">&quot;nativeName&quot;</span><span class="p">:</span><span class="sa">u</span><span class="s2">&quot;русский&quot;</span><span class="p">},</span>
        <span class="p">{</span><span class="s2">&quot;code&quot;</span><span class="p">:</span><span class="s2">&quot;es&quot;</span><span class="p">,</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;Spanish, Castilian&quot;</span><span class="p">,</span><span class="s2">&quot;nativeName&quot;</span><span class="p">:</span><span class="sa">u</span><span class="s2">&quot;español, castellano&quot;</span><span class="p">},</span>
        <span class="p">{</span><span class="s2">&quot;code&quot;</span><span class="p">:</span><span class="s2">&quot;sv&quot;</span><span class="p">,</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;Swedish&quot;</span><span class="p">,</span><span class="s2">&quot;nativeName&quot;</span><span class="p">:</span><span class="sa">u</span><span class="s2">&quot;svenska&quot;</span><span class="p">},</span>
    <span class="p">]</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">RAW_DATA</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">):</span>
        <span class="p">(</span><span class="n">alpha_3</span><span class="p">,</span> <span class="n">terminologic_code</span><span class="p">,</span> <span class="n">alpha_2</span><span class="p">,</span> <span class="n">names</span><span class="p">,</span>
         <span class="n">french_names</span><span class="p">)</span> <span class="o">=</span> <span class="n">i</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;|&quot;</span><span class="p">)</span>
        <span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">names</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;;&quot;</span><span class="p">)]</span>
        <span class="k">if</span> <span class="n">alpha_2</span><span class="p">:</span>
            <span class="n">three_to_two</span><span class="p">[</span><span class="n">alpha_3</span><span class="p">]</span> <span class="o">=</span> <span class="n">alpha_2</span>
            <span class="n">english_names</span><span class="p">[</span><span class="n">alpha_2</span><span class="p">]</span> <span class="o">=</span> <span class="n">names</span>
            <span class="n">two_to_three</span><span class="p">[</span><span class="n">alpha_2</span><span class="p">]</span> <span class="o">=</span> <span class="n">alpha_3</span>
        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">names</span><span class="p">:</span>
            <span class="n">english_names_to_three</span><span class="p">[</span><span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()]</span> <span class="o">=</span> <span class="n">alpha_3</span>
        <span class="n">english_names</span><span class="p">[</span><span class="n">alpha_3</span><span class="p">]</span> <span class="o">=</span> <span class="n">names</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">NATIVE_NAMES_RAW_DATA</span><span class="p">:</span>
        <span class="n">alpha_2</span> <span class="o">=</span> <span class="n">i</span><span class="p">[</span><span class="s1">&#39;code&#39;</span><span class="p">]</span>
        <span class="n">alpha_3</span> <span class="o">=</span> <span class="n">two_to_three</span><span class="p">[</span><span class="n">alpha_2</span><span class="p">]</span>
        <span class="n">names</span> <span class="o">=</span> <span class="n">i</span><span class="p">[</span><span class="s1">&#39;nativeName&#39;</span><span class="p">]</span>
        <span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">names</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)]</span>
        <span class="n">native_names</span><span class="p">[</span><span class="n">alpha_2</span><span class="p">]</span> <span class="o">=</span> <span class="n">names</span>
        <span class="n">native_names</span><span class="p">[</span><span class="n">alpha_3</span><span class="p">]</span> <span class="o">=</span> <span class="n">names</span>

<div class="viewcode-block" id="LanguageCodes.iso_639_2_for_locale"><a class="viewcode-back" href="../../core.util.html#core.util.LanguageCodes.iso_639_2_for_locale">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">iso_639_2_for_locale</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">locale</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Turn a locale code into an ISO-639-2 alpha-3 language code.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="s1">&#39;-&#39;</span> <span class="ow">in</span> <span class="n">locale</span><span class="p">:</span>
            <span class="n">language</span><span class="p">,</span> <span class="n">place</span> <span class="o">=</span> <span class="n">locale</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">language</span> <span class="o">=</span> <span class="n">locale</span>
        <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">two_to_three</span><span class="p">[</span><span class="n">language</span><span class="p">]:</span>
            <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">two_to_three</span><span class="p">[</span><span class="n">language</span><span class="p">]</span>
        <span class="k">elif</span> <span class="bp">cls</span><span class="o">.</span><span class="n">three_to_two</span><span class="p">[</span><span class="n">language</span><span class="p">]:</span>
            <span class="c1"># It&#39;s already ISO-639-2.</span>
            <span class="k">return</span> <span class="n">language</span>
        <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="LanguageCodes.string_to_alpha_3"><a class="viewcode-back" href="../../core.util.html#core.util.LanguageCodes.string_to_alpha_3">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">string_to_alpha_3</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Try really hard to convert a string to an ISO-639-2 alpha-3 language code.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">s</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">english_names_to_three</span><span class="p">:</span>
            <span class="c1"># It&#39;s the English name of a language.</span>
            <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">english_names_to_three</span><span class="p">[</span><span class="n">s</span><span class="p">]</span>

        <span class="k">if</span> <span class="s2">&quot;-&quot;</span> <span class="ow">in</span> <span class="n">s</span><span class="p">:</span>
            <span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">three_to_two</span><span class="p">:</span>
            <span class="c1"># It&#39;s already an alpha-3.</span>
            <span class="k">return</span> <span class="n">s</span>
        <span class="k">elif</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">two_to_three</span><span class="p">:</span>
            <span class="c1"># It&#39;s an alpha-2.</span>
            <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">two_to_three</span><span class="p">[</span><span class="n">s</span><span class="p">]</span>

        <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="LanguageCodes.name_for_languageset"><a class="viewcode-back" href="../../core.util.html#core.util.LanguageCodes.name_for_languageset">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">name_for_languageset</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">languages</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">languages</span><span class="p">,</span> <span class="n">basestring</span><span class="p">):</span>
            <span class="n">languages</span> <span class="o">=</span> <span class="n">languages</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
        <span class="n">all_names</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">languages</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;&quot;</span>
        <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">languages</span><span class="p">:</span>
            <span class="n">normalized</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">string_to_alpha_3</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
            <span class="n">native_names</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">native_names</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">normalized</span><span class="p">,</span> <span class="p">[])</span>
            <span class="k">if</span> <span class="n">native_names</span><span class="p">:</span>
                <span class="n">all_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">native_names</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">names</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">english_names</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">normalized</span><span class="p">,</span> <span class="p">[])</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">names</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No native or English name for </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">l</span><span class="p">)</span>
                <span class="n">all_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">names</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_names</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">all_names</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="s2">&quot;/&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">all_names</span><span class="p">)</span></div></div>

<div class="viewcode-block" id="languages_from_accept"><a class="viewcode-back" href="../../core.util.html#core.util.languages_from_accept">[docs]</a><span class="k">def</span> <span class="nf">languages_from_accept</span><span class="p">(</span><span class="n">accept_languages</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Turn a list of (locale, quality) 2-tuples into a list of language codes.&quot;&quot;&quot;</span>
    <span class="n">seen</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([])</span>
    <span class="n">languages</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">locale</span><span class="p">,</span> <span class="n">quality</span> <span class="ow">in</span> <span class="n">accept_languages</span><span class="p">:</span>
        <span class="n">language</span> <span class="o">=</span> <span class="n">LanguageCodes</span><span class="o">.</span><span class="n">iso_639_2_for_locale</span><span class="p">(</span><span class="n">locale</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">language</span> <span class="ow">and</span> <span class="n">language</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">seen</span><span class="p">:</span>
            <span class="n">languages</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">language</span><span class="p">)</span>
            <span class="n">seen</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">language</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">languages</span><span class="p">:</span>
        <span class="n">languages</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;DEFAULT_LANGUAGES&#39;</span><span class="p">,</span> <span class="s1">&#39;eng&#39;</span><span class="p">)</span>
        <span class="n">languages</span> <span class="o">=</span> <span class="n">languages</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">languages</span></div>


<div class="viewcode-block" id="MetadataSimilarity"><a class="viewcode-back" href="../../core.util.html#core.util.MetadataSimilarity">[docs]</a><span class="k">class</span> <span class="nc">MetadataSimilarity</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Estimate how similar two bits of metadata are.&quot;&quot;&quot;</span>

    <span class="n">SEPARATOR</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s2">&quot;\W&quot;</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_wordbag</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">set</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">_wordlist</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_wordlist</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">SEPARATOR</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">strip</span><span class="p">()]</span>

<div class="viewcode-block" id="MetadataSimilarity.histogram"><a class="viewcode-back" href="../../core.util.html#core.util.MetadataSimilarity.histogram">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">histogram</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">strings</span><span class="p">,</span> <span class="n">stopwords</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a histogram of word frequencies across the given list of</span>
<span class="sd">        strings.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">histogram</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">()</span>
        <span class="n">words</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">string</span> <span class="ow">in</span> <span class="n">strings</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_wordlist</span><span class="p">(</span><span class="n">string</span><span class="p">):</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">stopwords</span> <span class="ow">or</span> <span class="n">word</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">stopwords</span><span class="p">:</span>
                    <span class="n">histogram</span><span class="p">[</span><span class="n">word</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="n">words</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">normalize_histogram</span><span class="p">(</span><span class="n">histogram</span><span class="p">,</span> <span class="n">words</span><span class="p">)</span></div>

<div class="viewcode-block" id="MetadataSimilarity.normalize_histogram"><a class="viewcode-back" href="../../core.util.html#core.util.MetadataSimilarity.normalize_histogram">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">normalize_histogram</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">histogram</span><span class="p">,</span> <span class="n">total</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">total</span><span class="p">:</span>
            <span class="n">total</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">histogram</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
        <span class="n">total</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">total</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">histogram</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">histogram</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="o">/</span><span class="n">total</span>
        <span class="k">return</span> <span class="n">histogram</span></div>

<div class="viewcode-block" id="MetadataSimilarity.histogram_distance"><a class="viewcode-back" href="../../core.util.html#core.util.MetadataSimilarity.histogram_distance">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">histogram_distance</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">strings_1</span><span class="p">,</span> <span class="n">strings_2</span><span class="p">,</span> <span class="n">stopwords</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculate the histogram distance between two sets of strings.</span>

<span class="sd">        The histogram distance is the sum of the word distance for</span>
<span class="sd">        every word that occurs in either histogram.</span>

<span class="sd">        If a word appears in one histogram but not the other, its word</span>
<span class="sd">        distance is its frequency of appearance. If a word appears in</span>
<span class="sd">        both histograms, its word distance is the absolute value of</span>
<span class="sd">        the difference between that word&#39;s frequency of appearance in</span>
<span class="sd">        histogram A, and its frequency of appearance in histogram B.</span>

<span class="sd">        If the strings use the same words at exactly the same</span>
<span class="sd">        frequency, the difference will be 0. If the strings use</span>
<span class="sd">        completely different words, the difference will be 1.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">stopwords</span><span class="p">:</span>
            <span class="n">stopwords</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="s2">&quot;the&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;an&quot;</span><span class="p">])</span>

        <span class="n">histogram_1</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">strings_1</span><span class="p">,</span> <span class="n">stopwords</span><span class="o">=</span><span class="n">stopwords</span><span class="p">)</span>
        <span class="n">histogram_2</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">strings_2</span><span class="p">,</span> <span class="n">stopwords</span><span class="o">=</span><span class="n">stopwords</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">counter_distance</span><span class="p">(</span><span class="n">histogram_1</span><span class="p">,</span> <span class="n">histogram_2</span><span class="p">)</span></div>

<div class="viewcode-block" id="MetadataSimilarity.counter_distance"><a class="viewcode-back" href="../../core.util.html#core.util.MetadataSimilarity.counter_distance">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">counter_distance</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">counter1</span><span class="p">,</span> <span class="n">counter2</span><span class="p">):</span>
        <span class="n">differences</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># For every item that appears in histogram 1, compare its</span>
        <span class="c1"># frequency against the frequency of that item in histogram 2.</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">counter1</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">difference</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">v</span> <span class="o">-</span> <span class="n">counter2</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
            <span class="n">differences</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">difference</span><span class="p">)</span>

        <span class="c1"># Add the frequency of every item that appears in histogram 2</span>
        <span class="c1"># titles but not in histogram 1.</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">counter2</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">counter1</span><span class="p">:</span>
                <span class="n">differences</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>

        <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="n">differences</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span></div>


<div class="viewcode-block" id="MetadataSimilarity.most_common"><a class="viewcode-back" href="../../core.util.html#core.util.MetadataSimilarity.most_common">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">most_common</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">maximum_size</span><span class="p">,</span> <span class="o">*</span><span class="n">items</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the most common item that&#39;s not longer than the max.&quot;&quot;&quot;</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">items</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">i</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">maximum_size</span><span class="p">:</span>
                <span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="n">common</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">most_common</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">common</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">common</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span></div>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_wordbags_for_author</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">author</span><span class="p">):</span>
        <span class="n">bags</span> <span class="o">=</span> <span class="p">[</span><span class="bp">cls</span><span class="o">.</span><span class="n">_wordbag</span><span class="p">(</span><span class="n">author</span><span class="o">.</span><span class="n">sort_name</span><span class="p">)]</span>
        <span class="k">for</span> <span class="n">alias</span> <span class="ow">in</span> <span class="n">author</span><span class="o">.</span><span class="n">aliases</span><span class="p">:</span>
            <span class="n">bags</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">_wordbag</span><span class="p">(</span><span class="n">alias</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">bags</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_matching_author_in</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">to_match</span><span class="p">,</span> <span class="n">authors</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">author</span> <span class="ow">in</span> <span class="n">authors</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">author</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">to_match</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">name</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_word_match_proportion</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">,</span> <span class="n">stopwords</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;What proportion of words do s1 and s2 share, considered as wordbags?&quot;&quot;&quot;</span>
        <span class="n">b1</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_wordbag</span><span class="p">(</span><span class="n">s1</span><span class="p">)</span> <span class="o">-</span> <span class="n">stopwords</span>
        <span class="n">b2</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_wordbag</span><span class="p">(</span><span class="n">s2</span><span class="p">)</span> <span class="o">-</span> <span class="n">stopwords</span>
        <span class="k">return</span> <span class="n">b1</span><span class="p">,</span> <span class="n">b2</span><span class="p">,</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_proportion</span><span class="p">(</span><span class="n">b1</span><span class="p">,</span> <span class="n">b2</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_proportion</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">s1</span> <span class="o">==</span> <span class="n">s2</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
        <span class="n">total</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">s1</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">s2</span><span class="p">))</span>
        <span class="n">shared</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">s1</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">s2</span><span class="p">))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">total</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="k">return</span> <span class="n">shared</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="n">total</span><span class="p">)</span>

<div class="viewcode-block" id="MetadataSimilarity.title_similarity"><a class="viewcode-back" href="../../core.util.html#core.util.MetadataSimilarity.title_similarity">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">title_similarity</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">title1</span><span class="p">,</span> <span class="n">title2</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">title1</span> <span class="o">==</span> <span class="n">title2</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">title1</span> <span class="o">==</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">title2</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="n">b1</span><span class="p">,</span> <span class="n">b2</span><span class="p">,</span> <span class="n">proportion</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_word_match_proportion</span><span class="p">(</span>
            <span class="n">title1</span><span class="p">,</span> <span class="n">title2</span><span class="p">,</span> <span class="nb">set</span><span class="p">([</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;the&#39;</span><span class="p">,</span> <span class="s1">&#39;an&#39;</span><span class="p">]))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">b1</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">b2</span><span class="p">)</span> <span class="ow">in</span> <span class="p">(</span><span class="n">b1</span><span class="p">,</span> <span class="n">b2</span><span class="p">):</span>
            <span class="c1"># Penalize titles where one title is not a subset of the</span>
            <span class="c1"># other. &quot;Tom Sawyer Abroad&quot; will not face an extra</span>
            <span class="c1"># penalty vis-a-vis &quot;Tom Sawyer&quot;, but it will face an</span>
            <span class="c1"># extra penalty vis-a-vis &quot;Tom Sawyer, Detective&quot;.</span>
            <span class="n">proportion</span> <span class="o">*=</span> <span class="mf">0.4</span>
        <span class="k">return</span> <span class="n">proportion</span></div>

<div class="viewcode-block" id="MetadataSimilarity.author_similarity"><a class="viewcode-back" href="../../core.util.html#core.util.MetadataSimilarity.author_similarity">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">author_similarity</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">authors1</span><span class="p">,</span> <span class="n">authors2</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;What percentage of the total number of authors in the two sets</span>
<span class="sd">        are present in both sets?</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_proportion</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">authors1</span><span class="p">),</span> <span class="nb">set</span><span class="p">(</span><span class="n">authors2</span><span class="p">))</span></div>

<div class="viewcode-block" id="MetadataSimilarity.author_name_similarity"><a class="viewcode-back" href="../../core.util.html#core.util.MetadataSimilarity.author_name_similarity">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">author_name_similarity</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">authors1</span><span class="p">,</span> <span class="n">authors2</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;What percentage of the total number of authors in the two sets</span>
<span class="sd">        are present in both sets?</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_proportion</span><span class="p">(</span>
            <span class="nb">set</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">sort_name</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">authors1</span><span class="p">]),</span> <span class="nb">set</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">sort_name</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">authors2</span><span class="p">]))</span></div></div>

<div class="viewcode-block" id="TitleProcessor"><a class="viewcode-back" href="../../core.util.html#core.util.TitleProcessor">[docs]</a><span class="k">class</span> <span class="nc">TitleProcessor</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

    <span class="n">title_stopwords</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;The &#39;</span><span class="p">,</span> <span class="s1">&#39;A &#39;</span><span class="p">,</span> <span class="s1">&#39;An &#39;</span><span class="p">]</span>

<div class="viewcode-block" id="TitleProcessor.sort_title_for"><a class="viewcode-back" href="../../core.util.html#core.util.TitleProcessor.sort_title_for">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">sort_title_for</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">title</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">title</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">title</span>
        <span class="k">for</span> <span class="n">stopword</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">title_stopwords</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">title</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">stopword</span><span class="p">):</span>
                <span class="n">title</span> <span class="o">=</span> <span class="n">title</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">stopword</span><span class="p">):]</span> <span class="o">+</span> <span class="s2">&quot;, &quot;</span> <span class="o">+</span> <span class="n">stopword</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                <span class="k">break</span>
        <span class="k">return</span> <span class="n">title</span></div>

<div class="viewcode-block" id="TitleProcessor.extract_subtitle"><a class="viewcode-back" href="../../core.util.html#core.util.TitleProcessor.extract_subtitle">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">extract_subtitle</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">main_title</span><span class="p">,</span> <span class="n">subtitled_title</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Extracts a subtitle given a shorter and longer title version</span>

<span class="sd">        :return: subtitle or None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">subtitled_title</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="n">subtitle</span> <span class="o">=</span> <span class="n">subtitled_title</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">main_title</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="k">while</span> <span class="p">(</span><span class="n">subtitle</span> <span class="ow">and</span>
                <span class="p">(</span><span class="n">subtitle</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="n">string</span><span class="o">.</span><span class="n">whitespace</span><span class="o">+</span><span class="s1">&#39;:.&#39;</span><span class="p">)):</span>
            <span class="c1"># Trim any leading whitespace or colons</span>
            <span class="n">subtitle</span> <span class="o">=</span> <span class="n">subtitle</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">subtitle</span><span class="p">:</span>
            <span class="c1"># The main title and the full title were the same.</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">subtitle</span></div></div>


<div class="viewcode-block" id="Bigrams"><a class="viewcode-back" href="../../core.util.html#core.util.Bigrams">[docs]</a><span class="k">class</span> <span class="nc">Bigrams</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

    <span class="n">all_letters</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s2">&quot;^[a-z]+$&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bigrams</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bigrams</span> <span class="o">=</span> <span class="n">bigrams</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">proportional</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">()</span>
        <span class="n">total</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">bigrams</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
        <span class="k">for</span> <span class="n">bigram</span><span class="p">,</span> <span class="n">quantity</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">bigrams</span><span class="o">.</span><span class="n">most_common</span><span class="p">():</span>
            <span class="n">proportion</span> <span class="o">=</span> <span class="n">quantity</span><span class="o">/</span><span class="n">total</span>
            <span class="k">if</span> <span class="n">proportion</span> <span class="o">&lt;</span> <span class="mf">0.001</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">proportional</span><span class="p">[</span><span class="n">bigram</span><span class="p">]</span> <span class="o">=</span> <span class="n">proportion</span>

<div class="viewcode-block" id="Bigrams.difference_from"><a class="viewcode-back" href="../../core.util.html#core.util.Bigrams.difference_from">[docs]</a>    <span class="k">def</span> <span class="nf">difference_from</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other_bigrams</span><span class="p">):</span>
        <span class="n">total_difference</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">bigram</span><span class="p">,</span> <span class="n">proportion</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">proportional</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">other_proportion</span> <span class="o">=</span> <span class="n">other_bigrams</span><span class="o">.</span><span class="n">proportional</span><span class="p">[</span><span class="n">bigram</span><span class="p">]</span>
            <span class="n">difference</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">other_proportion</span> <span class="o">-</span> <span class="n">proportion</span><span class="p">)</span>
            <span class="n">total_difference</span> <span class="o">+=</span> <span class="n">difference</span>
            <span class="c1"># print &quot;%s %.4f-%.4f = %.4f =&gt; %.4f&quot; % (bigram, other_proportion, proportion, difference, total_difference)</span>
        <span class="k">for</span> <span class="n">bigram</span><span class="p">,</span> <span class="n">proportion</span> <span class="ow">in</span> <span class="n">other_bigrams</span><span class="o">.</span><span class="n">proportional</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">bigram</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">proportional</span><span class="p">:</span>
                <span class="n">total_difference</span> <span class="o">+=</span> <span class="n">proportion</span>
                <span class="c1"># print &quot;%s MISSING %.4f =&gt; %.4f&quot; % (bigram, proportion, total_difference)</span>
        <span class="k">return</span> <span class="n">total_difference</span></div>

<div class="viewcode-block" id="Bigrams.from_text_files"><a class="viewcode-back" href="../../core.util.html#core.util.Bigrams.from_text_files">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_text_files</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">paths</span><span class="p">):</span>
        <span class="n">bigrams</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">paths</span><span class="p">:</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">process_data</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="n">bigrams</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Bigrams</span><span class="p">(</span><span class="n">bigrams</span><span class="p">)</span></div>

<div class="viewcode-block" id="Bigrams.from_string"><a class="viewcode-back" href="../../core.util.html#core.util.Bigrams.from_string">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_string</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">string</span><span class="p">):</span>
        <span class="n">bigrams</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">()</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">process_data</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="n">bigrams</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Bigrams</span><span class="p">(</span><span class="n">bigrams</span><span class="p">)</span></div>

<div class="viewcode-block" id="Bigrams.process_data"><a class="viewcode-back" href="../../core.util.html#core.util.Bigrams.process_data">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">process_data</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">bigrams</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">bigram</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">bigram</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="bp">cls</span><span class="o">.</span><span class="n">all_letters</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">bigram</span><span class="p">):</span>
                <span class="n">bigrams</span><span class="p">[</span><span class="n">bigram</span><span class="o">.</span><span class="n">lower</span><span class="p">()]</span> <span class="o">+=</span> <span class="mi">1</span></div></div>

<span class="n">english_bigram_frequencies</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;ab&quot;</span><span class="p">:</span> <span class="mf">0.0021712725750437792</span><span class="p">,</span>
    <span class="s2">&quot;ac&quot;</span><span class="p">:</span> <span class="mf">0.005213707466347486</span><span class="p">,</span>
    <span class="s2">&quot;ad&quot;</span><span class="p">:</span> <span class="mf">0.004761174757224308</span><span class="p">,</span>
    <span class="s2">&quot;ag&quot;</span><span class="p">:</span> <span class="mf">0.002362898803662714</span><span class="p">,</span>
    <span class="s2">&quot;ai&quot;</span><span class="p">:</span> <span class="mf">0.004243783939953184</span><span class="p">,</span>
    <span class="s2">&quot;ak&quot;</span><span class="p">:</span> <span class="mf">0.0016317710390858545</span><span class="p">,</span>
    <span class="s2">&quot;al&quot;</span><span class="p">:</span> <span class="mf">0.009420640208489336</span><span class="p">,</span>
    <span class="s2">&quot;am&quot;</span><span class="p">:</span> <span class="mf">0.0022184421082422864</span><span class="p">,</span>
    <span class="s2">&quot;an&quot;</span><span class="p">:</span> <span class="mf">0.019261384072027876</span><span class="p">,</span>
    <span class="s2">&quot;ap&quot;</span><span class="p">:</span> <span class="mf">0.001748220824169669</span><span class="p">,</span>
    <span class="s2">&quot;ar&quot;</span><span class="p">:</span> <span class="mf">0.010173878691752996</span><span class="p">,</span>
    <span class="s2">&quot;as&quot;</span><span class="p">:</span> <span class="mf">0.009223117788220589</span><span class="p">,</span>
    <span class="s2">&quot;at&quot;</span><span class="p">:</span> <span class="mf">0.01276525492184598</span><span class="p">,</span>
    <span class="s2">&quot;au&quot;</span><span class="p">:</span> <span class="mf">0.0010539442574041427</span><span class="p">,</span>
    <span class="s2">&quot;av&quot;</span><span class="p">:</span> <span class="mf">0.0018941515675025501</span><span class="p">,</span>
    <span class="s2">&quot;ay&quot;</span><span class="p">:</span> <span class="mf">0.0026193831404295966</span><span class="p">,</span>
    <span class="s2">&quot;ba&quot;</span><span class="p">:</span> <span class="mf">0.001463729577066173</span><span class="p">,</span>
    <span class="s2">&quot;be&quot;</span><span class="p">:</span> <span class="mf">0.005828385445840531</span><span class="p">,</span>
    <span class="s2">&quot;bl&quot;</span><span class="p">:</span> <span class="mf">0.002477874540834075</span><span class="p">,</span>
    <span class="s2">&quot;bo&quot;</span><span class="p">:</span> <span class="mf">0.0026577083861533835</span><span class="p">,</span>
    <span class="s2">&quot;br&quot;</span><span class="p">:</span> <span class="mf">0.0010568923532290493</span><span class="p">,</span>
    <span class="s2">&quot;bu&quot;</span><span class="p">:</span> <span class="mf">0.002104940418983379</span><span class="p">,</span>
    <span class="s2">&quot;by&quot;</span><span class="p">:</span> <span class="mf">0.0013163247858208383</span><span class="p">,</span>
    <span class="s2">&quot;ca&quot;</span><span class="p">:</span> <span class="mf">0.004967541464967778</span><span class="p">,</span>
    <span class="s2">&quot;ce&quot;</span><span class="p">:</span> <span class="mf">0.006574253689541925</span><span class="p">,</span>
    <span class="s2">&quot;ch&quot;</span><span class="p">:</span> <span class="mf">0.004742012134362416</span><span class="p">,</span>
    <span class="s2">&quot;ci&quot;</span><span class="p">:</span> <span class="mf">0.002072511364909405</span><span class="p">,</span>
    <span class="s2">&quot;ck&quot;</span><span class="p">:</span> <span class="mf">0.0032694382698215223</span><span class="p">,</span>
    <span class="s2">&quot;cl&quot;</span><span class="p">:</span> <span class="mf">0.0010966916468652897</span><span class="p">,</span>
    <span class="s2">&quot;co&quot;</span><span class="p">:</span> <span class="mf">0.007743173684117428</span><span class="p">,</span>
    <span class="s2">&quot;cr&quot;</span><span class="p">:</span> <span class="mf">0.0021771687666935925</span><span class="p">,</span>
    <span class="s2">&quot;ct&quot;</span><span class="p">:</span> <span class="mf">0.0035804623793491783</span><span class="p">,</span>
    <span class="s2">&quot;cu&quot;</span><span class="p">:</span> <span class="mf">0.0016922070034964417</span><span class="p">,</span>
    <span class="s2">&quot;da&quot;</span><span class="p">:</span> <span class="mf">0.0015005807748775066</span><span class="p">,</span>
    <span class="s2">&quot;de&quot;</span><span class="p">:</span> <span class="mf">0.006702495857925366</span><span class="p">,</span>
    <span class="s2">&quot;di&quot;</span><span class="p">:</span> <span class="mf">0.003999091986485929</span><span class="p">,</span>
    <span class="s2">&quot;do&quot;</span><span class="p">:</span> <span class="mf">0.0031824694429867747</span><span class="p">,</span>
    <span class="s2">&quot;ds&quot;</span><span class="p">:</span> <span class="mf">0.0014740479124533464</span><span class="p">,</span>
    <span class="s2">&quot;ea&quot;</span><span class="p">:</span> <span class="mf">0.007121125465062116</span><span class="p">,</span>
    <span class="s2">&quot;ec&quot;</span><span class="p">:</span> <span class="mf">0.005023555285641005</span><span class="p">,</span>
    <span class="s2">&quot;ed&quot;</span><span class="p">:</span> <span class="mf">0.012741670155246725</span><span class="p">,</span>
    <span class="s2">&quot;ee&quot;</span><span class="p">:</span> <span class="mf">0.0045415416182687605</span><span class="p">,</span>
    <span class="s2">&quot;ef&quot;</span><span class="p">:</span> <span class="mf">0.0013325393128578251</span><span class="p">,</span>
    <span class="s2">&quot;eg&quot;</span><span class="p">:</span> <span class="mf">0.001064262592791316</span><span class="p">,</span>
    <span class="s2">&quot;ei&quot;</span><span class="p">:</span> <span class="mf">0.0018351896510044163</span><span class="p">,</span>
    <span class="s2">&quot;el&quot;</span><span class="p">:</span> <span class="mf">0.00604359644105872</span><span class="p">,</span>
    <span class="s2">&quot;em&quot;</span><span class="p">:</span> <span class="mf">0.003947500309550061</span><span class="p">,</span>
    <span class="s2">&quot;en&quot;</span><span class="p">:</span> <span class="mf">0.01328117169120465</span><span class="p">,</span>
    <span class="s2">&quot;ep&quot;</span><span class="p">:</span> <span class="mf">0.0017762277345062824</span><span class="p">,</span>
    <span class="s2">&quot;er&quot;</span><span class="p">:</span> <span class="mf">0.02339461441854706</span><span class="p">,</span>
    <span class="s2">&quot;es&quot;</span><span class="p">:</span> <span class="mf">0.010507013519967454</span><span class="p">,</span>
    <span class="s2">&quot;et&quot;</span><span class="p">:</span> <span class="mf">0.004740538086449962</span><span class="p">,</span>
    <span class="s2">&quot;ev&quot;</span><span class="p">:</span> <span class="mf">0.0024631340617095416</span><span class="p">,</span>
    <span class="s2">&quot;ew&quot;</span><span class="p">:</span> <span class="mf">0.001260310965147611</span><span class="p">,</span>
    <span class="s2">&quot;ex&quot;</span><span class="p">:</span> <span class="mf">0.0015035288707024132</span><span class="p">,</span>
    <span class="s2">&quot;ey&quot;</span><span class="p">:</span> <span class="mf">0.002464608109621995</span><span class="p">,</span>
    <span class="s2">&quot;fa&quot;</span><span class="p">:</span> <span class="mf">0.0013045324025212116</span><span class="p">,</span>
    <span class="s2">&quot;fe&quot;</span><span class="p">:</span> <span class="mf">0.002000283017199191</span><span class="p">,</span>
    <span class="s2">&quot;ff&quot;</span><span class="p">:</span> <span class="mf">0.0015919717454496141</span><span class="p">,</span>
    <span class="s2">&quot;fi&quot;</span><span class="p">:</span> <span class="mf">0.0024395492951102883</span><span class="p">,</span>
    <span class="s2">&quot;fo&quot;</span><span class="p">:</span> <span class="mf">0.004199562502579583</span><span class="p">,</span>
    <span class="s2">&quot;fr&quot;</span><span class="p">:</span> <span class="mf">0.0018233972677047896</span><span class="p">,</span>
    <span class="s2">&quot;ft&quot;</span><span class="p">:</span> <span class="mf">0.0012278819110736374</span><span class="p">,</span>
    <span class="s2">&quot;fu&quot;</span><span class="p">:</span> <span class="mf">0.0010524702094916894</span><span class="p">,</span>
    <span class="s2">&quot;ga&quot;</span><span class="p">:</span> <span class="mf">0.001748220824169669</span><span class="p">,</span>
    <span class="s2">&quot;ge&quot;</span><span class="p">:</span> <span class="mf">0.003719022883119793</span><span class="p">,</span>
    <span class="s2">&quot;gh&quot;</span><span class="p">:</span> <span class="mf">0.0031839434908992282</span><span class="p">,</span>
    <span class="s2">&quot;gi&quot;</span><span class="p">:</span> <span class="mf">0.0014755219603657997</span><span class="p">,</span>
    <span class="s2">&quot;go&quot;</span><span class="p">:</span> <span class="mf">0.0016332450869983078</span><span class="p">,</span>
    <span class="s2">&quot;gr&quot;</span><span class="p">:</span> <span class="mf">0.002012075400498818</span><span class="p">,</span>
    <span class="s2">&quot;ha&quot;</span><span class="p">:</span> <span class="mf">0.010978708851952524</span><span class="p">,</span>
    <span class="s2">&quot;he&quot;</span><span class="p">:</span> <span class="mf">0.03081791970566211</span><span class="p">,</span>
    <span class="s2">&quot;hi&quot;</span><span class="p">:</span> <span class="mf">0.007993761829234497</span><span class="p">,</span>
    <span class="s2">&quot;ho&quot;</span><span class="p">:</span> <span class="mf">0.00562496683392197</span><span class="p">,</span>
    <span class="s2">&quot;hr&quot;</span><span class="p">:</span> <span class="mf">0.0012308300068985443</span><span class="p">,</span>
    <span class="s2">&quot;ht&quot;</span><span class="p">:</span> <span class="mf">0.002037134215010525</span><span class="p">,</span>
    <span class="s2">&quot;ia&quot;</span><span class="p">:</span> <span class="mf">0.0017334803450451354</span><span class="p">,</span>
    <span class="s2">&quot;ib&quot;</span><span class="p">:</span> <span class="mf">0.001068684736528676</span><span class="p">,</span>
    <span class="s2">&quot;ic&quot;</span><span class="p">:</span> <span class="mf">0.007367291466441825</span><span class="p">,</span>
    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mf">0.004277687041939611</span><span class="p">,</span>
    <span class="s2">&quot;ie&quot;</span><span class="p">:</span> <span class="mf">0.0031692030117746947</span><span class="p">,</span>
    <span class="s2">&quot;if&quot;</span><span class="p">:</span> <span class="mf">0.001578705314237534</span><span class="p">,</span>
    <span class="s2">&quot;ig&quot;</span><span class="p">:</span> <span class="mf">0.0029687324956810396</span><span class="p">,</span>
    <span class="s2">&quot;il&quot;</span><span class="p">:</span> <span class="mf">0.004321908479313212</span><span class="p">,</span>
    <span class="s2">&quot;im&quot;</span><span class="p">:</span> <span class="mf">0.0030615975141656004</span><span class="p">,</span>
    <span class="s2">&quot;in&quot;</span><span class="p">:</span> <span class="mf">0.02371595686346189</span><span class="p">,</span>
    <span class="s2">&quot;io&quot;</span><span class="p">:</span> <span class="mf">0.005216655562172393</span><span class="p">,</span>
    <span class="s2">&quot;ir&quot;</span><span class="p">:</span> <span class="mf">0.003085182280764854</span><span class="p">,</span>
    <span class="s2">&quot;is&quot;</span><span class="p">:</span> <span class="mf">0.008928308205729919</span><span class="p">,</span>
    <span class="s2">&quot;it&quot;</span><span class="p">:</span> <span class="mf">0.011687725897842583</span><span class="p">,</span>
    <span class="s2">&quot;iv&quot;</span><span class="p">:</span> <span class="mf">0.0021801168625184995</span><span class="p">,</span>
    <span class="s2">&quot;ke&quot;</span><span class="p">:</span> <span class="mf">0.004137652490256543</span><span class="p">,</span>
    <span class="s2">&quot;ki&quot;</span><span class="p">:</span> <span class="mf">0.0015521724518133737</span><span class="p">,</span>
    <span class="s2">&quot;ks&quot;</span><span class="p">:</span> <span class="mf">0.0010657366407037694</span><span class="p">,</span>
    <span class="s2">&quot;la&quot;</span><span class="p">:</span> <span class="mf">0.003962240788674595</span><span class="p">,</span>
    <span class="s2">&quot;ld&quot;</span><span class="p">:</span> <span class="mf">0.0029628363040312264</span><span class="p">,</span>
    <span class="s2">&quot;le&quot;</span><span class="p">:</span> <span class="mf">0.009557726664347498</span><span class="p">,</span>
    <span class="s2">&quot;li&quot;</span><span class="p">:</span> <span class="mf">0.006910336613581288</span><span class="p">,</span>
    <span class="s2">&quot;ll&quot;</span><span class="p">:</span> <span class="mf">0.007724011061255535</span><span class="p">,</span>
    <span class="s2">&quot;lo&quot;</span><span class="p">:</span> <span class="mf">0.0036350021521099523</span><span class="p">,</span>
    <span class="s2">&quot;ls&quot;</span><span class="p">:</span> <span class="mf">0.0010274113949799825</span><span class="p">,</span>
    <span class="s2">&quot;ly&quot;</span><span class="p">:</span> <span class="mf">0.0051871746039233255</span><span class="p">,</span>
    <span class="s2">&quot;ma&quot;</span><span class="p">:</span> <span class="mf">0.004444254456046839</span><span class="p">,</span>
    <span class="s2">&quot;me&quot;</span><span class="p">:</span> <span class="mf">0.00833868904074858</span><span class="p">,</span>
    <span class="s2">&quot;mi&quot;</span><span class="p">:</span> <span class="mf">0.0025766357509684496</span><span class="p">,</span>
    <span class="s2">&quot;mo&quot;</span><span class="p">:</span> <span class="mf">0.0027977429378364515</span><span class="p">,</span>
    <span class="s2">&quot;mp&quot;</span><span class="p">:</span> <span class="mf">0.0029304072499572527</span><span class="p">,</span>
    <span class="s2">&quot;mu&quot;</span><span class="p">:</span> <span class="mf">0.0011689199945755036</span><span class="p">,</span>
    <span class="s2">&quot;my&quot;</span><span class="p">:</span> <span class="mf">0.0012558888214102512</span><span class="p">,</span>
    <span class="s2">&quot;na&quot;</span><span class="p">:</span> <span class="mf">0.0025810578947058093</span><span class="p">,</span>
    <span class="s2">&quot;nc&quot;</span><span class="p">:</span> <span class="mf">0.002830171991910425</span><span class="p">,</span>
    <span class="s2">&quot;nd&quot;</span><span class="p">:</span> <span class="mf">0.014385233577632207</span><span class="p">,</span>
    <span class="s2">&quot;ne&quot;</span><span class="p">:</span> <span class="mf">0.007968703014722791</span><span class="p">,</span>
    <span class="s2">&quot;ng&quot;</span><span class="p">:</span> <span class="mf">0.01172162899982901</span><span class="p">,</span>
    <span class="s2">&quot;ni&quot;</span><span class="p">:</span> <span class="mf">0.003599625002211072</span><span class="p">,</span>
    <span class="s2">&quot;no&quot;</span><span class="p">:</span> <span class="mf">0.004734641894800148</span><span class="p">,</span>
    <span class="s2">&quot;ns&quot;</span><span class="p">:</span> <span class="mf">0.003651216679146939</span><span class="p">,</span>
    <span class="s2">&quot;nt&quot;</span><span class="p">:</span> <span class="mf">0.008982847978490693</span><span class="p">,</span>
    <span class="s2">&quot;ny&quot;</span><span class="p">:</span> <span class="mf">0.0015698610267628138</span><span class="p">,</span>
    <span class="s2">&quot;oc&quot;</span><span class="p">:</span> <span class="mf">0.0017187398659206019</span><span class="p">,</span>
    <span class="s2">&quot;od&quot;</span><span class="p">:</span> <span class="mf">0.0017718055907689223</span><span class="p">,</span>
    <span class="s2">&quot;of&quot;</span><span class="p">:</span> <span class="mf">0.009453069262563311</span><span class="p">,</span>
    <span class="s2">&quot;oi&quot;</span><span class="p">:</span> <span class="mf">0.0010229892512426224</span><span class="p">,</span>
    <span class="s2">&quot;ok&quot;</span><span class="p">:</span> <span class="mf">0.0014946845832276932</span><span class="p">,</span>
    <span class="s2">&quot;ol&quot;</span><span class="p">:</span> <span class="mf">0.0031087670473641076</span><span class="p">,</span>
    <span class="s2">&quot;om&quot;</span><span class="p">:</span> <span class="mf">0.006596364408228725</span><span class="p">,</span>
    <span class="s2">&quot;on&quot;</span><span class="p">:</span> <span class="mf">0.015450970218335977</span><span class="p">,</span>
    <span class="s2">&quot;oo&quot;</span><span class="p">:</span> <span class="mf">0.0033667254320434432</span><span class="p">,</span>
    <span class="s2">&quot;op&quot;</span><span class="p">:</span> <span class="mf">0.0026650786257156503</span><span class="p">,</span>
    <span class="s2">&quot;or&quot;</span><span class="p">:</span> <span class="mf">0.012544147734977978</span><span class="p">,</span>
    <span class="s2">&quot;os&quot;</span><span class="p">:</span> <span class="mf">0.0024248088159857547</span><span class="p">,</span>
    <span class="s2">&quot;ot&quot;</span><span class="p">:</span> <span class="mf">0.004404455162410599</span><span class="p">,</span>
    <span class="s2">&quot;ou&quot;</span><span class="p">:</span> <span class="mf">0.012628168465987818</span><span class="p">,</span>
    <span class="s2">&quot;ov&quot;</span><span class="p">:</span> <span class="mf">0.0014814181520156132</span><span class="p">,</span>
    <span class="s2">&quot;ow&quot;</span><span class="p">:</span> <span class="mf">0.004357285629212092</span><span class="p">,</span>
    <span class="s2">&quot;pa&quot;</span><span class="p">:</span> <span class="mf">0.0024248088159857547</span><span class="p">,</span>
    <span class="s2">&quot;pe&quot;</span><span class="p">:</span> <span class="mf">0.004336648958437745</span><span class="p">,</span>
    <span class="s2">&quot;ph&quot;</span><span class="p">:</span> <span class="mf">0.001596393889186974</span><span class="p">,</span>
    <span class="s2">&quot;pi&quot;</span><span class="p">:</span> <span class="mf">0.0014047676605680392</span><span class="p">,</span>
    <span class="s2">&quot;pl&quot;</span><span class="p">:</span> <span class="mf">0.0026621305298907437</span><span class="p">,</span>
    <span class="s2">&quot;po&quot;</span><span class="p">:</span> <span class="mf">0.0027137222068266105</span><span class="p">,</span>
    <span class="s2">&quot;pp&quot;</span><span class="p">:</span> <span class="mf">0.0012897919233966781</span><span class="p">,</span>
    <span class="s2">&quot;pr&quot;</span><span class="p">:</span> <span class="mf">0.003148566341000348</span><span class="p">,</span>
    <span class="s2">&quot;pu&quot;</span><span class="p">:</span> <span class="mf">0.002514725738645409</span><span class="p">,</span>
    <span class="s2">&quot;qu&quot;</span><span class="p">:</span> <span class="mf">0.0011851345216124904</span><span class="p">,</span>
    <span class="s2">&quot;ra&quot;</span><span class="p">:</span> <span class="mf">0.00642242675455923</span><span class="p">,</span>
    <span class="s2">&quot;rc&quot;</span><span class="p">:</span> <span class="mf">0.001068684736528676</span><span class="p">,</span>
    <span class="s2">&quot;rd&quot;</span><span class="p">:</span> <span class="mf">0.0022656116414407935</span><span class="p">,</span>
    <span class="s2">&quot;re&quot;</span><span class="p">:</span> <span class="mf">0.016922070034964418</span><span class="p">,</span>
    <span class="s2">&quot;rg&quot;</span><span class="p">:</span> <span class="mf">0.0016332450869983078</span><span class="p">,</span>
    <span class="s2">&quot;ri&quot;</span><span class="p">:</span> <span class="mf">0.00681010135553446</span><span class="p">,</span>
    <span class="s2">&quot;rk&quot;</span><span class="p">:</span> <span class="mf">0.0017261101054828686</span><span class="p">,</span>
    <span class="s2">&quot;rl&quot;</span><span class="p">:</span> <span class="mf">0.001046574017841876</span><span class="p">,</span>
    <span class="s2">&quot;rm&quot;</span><span class="p">:</span> <span class="mf">0.0016317710390858545</span><span class="p">,</span>
    <span class="s2">&quot;rn&quot;</span><span class="p">:</span> <span class="mf">0.001328117169120465</span><span class="p">,</span>
    <span class="s2">&quot;ro&quot;</span><span class="p">:</span> <span class="mf">0.007760862259066869</span><span class="p">,</span>
    <span class="s2">&quot;rr&quot;</span><span class="p">:</span> <span class="mf">0.0010878473593905697</span><span class="p">,</span>
    <span class="s2">&quot;rs&quot;</span><span class="p">:</span> <span class="mf">0.004743486182274869</span><span class="p">,</span>
    <span class="s2">&quot;rt&quot;</span><span class="p">:</span> <span class="mf">0.0029893691664553863</span><span class="p">,</span>
    <span class="s2">&quot;ru&quot;</span><span class="p">:</span> <span class="mf">0.0013177988337332916</span><span class="p">,</span>
    <span class="s2">&quot;ry&quot;</span><span class="p">:</span> <span class="mf">0.002701929823526984</span><span class="p">,</span>
    <span class="s2">&quot;sa&quot;</span><span class="p">:</span> <span class="mf">0.0028758674771964788</span><span class="p">,</span>
    <span class="s2">&quot;sc&quot;</span><span class="p">:</span> <span class="mf">0.0012691552526223311</span><span class="p">,</span>
    <span class="s2">&quot;se&quot;</span><span class="p">:</span> <span class="mf">0.008092523039368872</span><span class="p">,</span>
    <span class="s2">&quot;sh&quot;</span><span class="p">:</span> <span class="mf">0.0038148359974292606</span><span class="p">,</span>
    <span class="s2">&quot;si&quot;</span><span class="p">:</span> <span class="mf">0.004310116096013585</span><span class="p">,</span>
    <span class="s2">&quot;so&quot;</span><span class="p">:</span> <span class="mf">0.0036910159727831793</span><span class="p">,</span>
    <span class="s2">&quot;sp&quot;</span><span class="p">:</span> <span class="mf">0.0017718055907689223</span><span class="p">,</span>
    <span class="s2">&quot;ss&quot;</span><span class="p">:</span> <span class="mf">0.0034404278276661104</span><span class="p">,</span>
    <span class="s2">&quot;st&quot;</span><span class="p">:</span> <span class="mf">0.01015324202097865</span><span class="p">,</span>
    <span class="s2">&quot;su&quot;</span><span class="p">:</span> <span class="mf">0.0018631965613410298</span><span class="p">,</span>
    <span class="s2">&quot;ta&quot;</span><span class="p">:</span> <span class="mf">0.004728745703150335</span><span class="p">,</span>
    <span class="s2">&quot;te&quot;</span><span class="p">:</span> <span class="mf">0.013699801298341401</span><span class="p">,</span>
    <span class="s2">&quot;th&quot;</span><span class="p">:</span> <span class="mf">0.031493033649565745</span><span class="p">,</span>
    <span class="s2">&quot;ti&quot;</span><span class="p">:</span> <span class="mf">0.009472231885425203</span><span class="p">,</span>
    <span class="s2">&quot;tl&quot;</span><span class="p">:</span> <span class="mf">0.0016745184285470015</span><span class="p">,</span>
    <span class="s2">&quot;to&quot;</span><span class="p">:</span> <span class="mf">0.010639677832088254</span><span class="p">,</span>
    <span class="s2">&quot;tr&quot;</span><span class="p">:</span> <span class="mf">0.0039519224532874216</span><span class="p">,</span>
    <span class="s2">&quot;ts&quot;</span><span class="p">:</span> <span class="mf">0.0027933207940990913</span><span class="p">,</span>
    <span class="s2">&quot;tt&quot;</span><span class="p">:</span> <span class="mf">0.0022449749706664464</span><span class="p">,</span>
    <span class="s2">&quot;tu&quot;</span><span class="p">:</span> <span class="mf">0.0017644353512066555</span><span class="p">,</span>
    <span class="s2">&quot;ty&quot;</span><span class="p">:</span> <span class="mf">0.0020164975442361777</span><span class="p">,</span>
    <span class="s2">&quot;ub&quot;</span><span class="p">:</span> <span class="mf">0.0011114321259898233</span><span class="p">,</span>
    <span class="s2">&quot;uc&quot;</span><span class="p">:</span> <span class="mf">0.0013590721752819853</span><span class="p">,</span>
    <span class="s2">&quot;ue&quot;</span><span class="p">:</span> <span class="mf">0.0012529407255853443</span><span class="p">,</span>
    <span class="s2">&quot;ug&quot;</span><span class="p">:</span> <span class="mf">0.0015904976975371608</span><span class="p">,</span>
    <span class="s2">&quot;ui&quot;</span><span class="p">:</span> <span class="mf">0.0010952175989528364</span><span class="p">,</span>
    <span class="s2">&quot;ul&quot;</span><span class="p">:</span> <span class="mf">0.0035052859358140577</span><span class="p">,</span>
    <span class="s2">&quot;um&quot;</span><span class="p">:</span> <span class="mf">0.0012323040548109976</span><span class="p">,</span>
    <span class="s2">&quot;un&quot;</span><span class="p">:</span> <span class="mf">0.004690420457426548</span><span class="p">,</span>
    <span class="s2">&quot;up&quot;</span><span class="p">:</span> <span class="mf">0.0018956256154150034</span><span class="p">,</span>
    <span class="s2">&quot;ur&quot;</span><span class="p">:</span> <span class="mf">0.0044309880248347595</span><span class="p">,</span>
    <span class="s2">&quot;us&quot;</span><span class="p">:</span> <span class="mf">0.004758226661399402</span><span class="p">,</span>
    <span class="s2">&quot;ut&quot;</span><span class="p">:</span> <span class="mf">0.007224308818933851</span><span class="p">,</span>
    <span class="s2">&quot;ve&quot;</span><span class="p">:</span> <span class="mf">0.008085152799806605</span><span class="p">,</span>
    <span class="s2">&quot;vi&quot;</span><span class="p">:</span> <span class="mf">0.0024498676304974616</span><span class="p">,</span>
    <span class="s2">&quot;wa&quot;</span><span class="p">:</span> <span class="mf">0.00562938897765933</span><span class="p">,</span>
    <span class="s2">&quot;we&quot;</span><span class="p">:</span> <span class="mf">0.0034581164026155505</span><span class="p">,</span>
    <span class="s2">&quot;wh&quot;</span><span class="p">:</span> <span class="mf">0.0031721511075996013</span><span class="p">,</span>
    <span class="s2">&quot;wi&quot;</span><span class="p">:</span> <span class="mf">0.0038531612431530475</span><span class="p">,</span>
    <span class="s2">&quot;wn&quot;</span><span class="p">:</span> <span class="mf">0.0013413836003325452</span><span class="p">,</span>
    <span class="s2">&quot;wo&quot;</span><span class="p">:</span> <span class="mf">0.0029937913101927465</span><span class="p">,</span>
    <span class="s2">&quot;ye&quot;</span><span class="p">:</span> <span class="mf">0.0010288854428924358</span><span class="p">,</span>
    <span class="s2">&quot;yo&quot;</span><span class="p">:</span> <span class="mf">0.002843438423122505</span><span class="p">,</span>
    <span class="s2">&quot;ys&quot;</span><span class="p">:</span> <span class="mf">0.0013649683669317988</span>
<span class="p">}</span>
<span class="n">english_bigrams</span> <span class="o">=</span> <span class="n">Bigrams</span><span class="p">(</span><span class="n">Counter</span><span class="p">())</span>
<span class="n">english_bigrams</span><span class="o">.</span><span class="n">proportional</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="n">english_bigram_frequencies</span><span class="p">)</span>


<div class="viewcode-block" id="MoneyUtility"><a class="viewcode-back" href="../../core.util.html#core.util.MoneyUtility">[docs]</a><span class="k">class</span> <span class="nc">MoneyUtility</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

    <span class="n">DEFAULT_CURRENCY</span> <span class="o">=</span> <span class="s1">&#39;USD&#39;</span>

<div class="viewcode-block" id="MoneyUtility.parse"><a class="viewcode-back" href="../../core.util.html#core.util.MoneyUtility.parse">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">parse</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">amount</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Attempt to turn a string into a Money object.&quot;&quot;&quot;</span>
        <span class="n">currency</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">DEFAULT_CURRENCY</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">amount</span><span class="p">:</span>
            <span class="n">amount</span> <span class="o">=</span> <span class="s1">&#39;0&#39;</span>
        <span class="n">amount</span> <span class="o">=</span> <span class="n">unicode</span><span class="p">(</span><span class="n">amount</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">amount</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;$&#39;</span><span class="p">:</span>
            <span class="n">currency</span> <span class="o">=</span> <span class="s1">&#39;USD&#39;</span>
            <span class="n">amount</span> <span class="o">=</span> <span class="n">amount</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
        <span class="k">return</span> <span class="n">Money</span><span class="p">(</span><span class="n">amount</span><span class="p">,</span> <span class="n">currency</span><span class="p">)</span></div></div>

</pre></div>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../index.html">Library Simplified Circulation Manager</a></h1>








<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../modules.html">circulation</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2019, The New York Public Library, Astor, Lenox, and Tilden Foundations.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.8.5</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
    </div>

    

    
  </body>
</html>